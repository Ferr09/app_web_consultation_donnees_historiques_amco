<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}AMCO - Interface{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script>
    // Définition de la variable STATIC_URL pour l'utilisation dans le JavaScript
        const STATIC_URL = "{{ url_for('static', filename='') }}";
    </script>
</head>

<body data-user-id="{{ current_user.id }}" data-page="resultats-simples">
    <div class="fond-ext">
        <div class="superposition">
            <div id="conteneur-notifications" class="conteneur-notifications"></div>
            <div class="container">
                <!-- Barre latérale -->
                <nav class="sidebar">
                    <ul class="nav-items">
                        <li>
                            <img src="{{ url_for('static', filename='images/logo-groupe-amco.png') }}" alt="Logo"
                                width="90">
                        </li>
                        <li>
                            <a href="{{ url_for('main.filtre_requete') }}" title="Requête simple">
                                <i class="fas fa-search"></i>
                                <span>Requête simple</span>
                            </a>
                        </li>
                        <li>
                            <a href="{{ url_for('main.filtre_requete_avancee') }}" title="Requête avancée">
                                <i class="fas fa-chart-line"></i>
                                <span>Requête avancée</span>
                            </a>
                        </li>
                        <li>
                            <a href="{{ url_for('main.documentation') }}" title="Documentation">
                                <i class="fas fa-file-alt"></i>
                                <span>Documentation</span>
                            </a>
                        </li>
                        <li>
                            <a href="{{ url_for('main.profil') }}" title="Mon Profil">
                                <i class="fas fa-user"></i>
                                <span>Mon Profil</span>
                            </a>
                        </li>
                        {# **Seulement pour les admins** #}
                        {% if current_user.is_authenticated and current_user.is_admin() %}
                        <li>
                            <a href="{{ url_for('admin.panel_admin') }}" title="Administration">
                                <i class="fas fa-cog"></i>
                                <span>Administration</span>
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                    <div class="logout">
                        <a href="{{ url_for('auth.logout') }}" title="Sortir">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Sortir</span>
                        </a>
                    </div>
                </nav>


                <!-- Contenu principal -->
                <main class="content">
                    <!-- 1) Entête avec bouton Retour -->
                    <div class="results-header">
                        <button class="btn-back" onclick="window.history.back()" aria-label="Retour">
                            <img src="{{ url_for('static', filename='images/left-arrow.png') }}" alt="Retour" width="30" height="30">
                        </button>
                        <h1>Résultats de la requête</h1>
                    </div>

                    <!-- 2) Barre de téléchargement -->
                    <div class="download-bar">
                        <button class="download-main" id="btn-download">Télécharger</button>
                        <div class="download-options toggle-group">
                            <label>
                                <input type="radio" name="download_format" value="csv" checked>
                                <span>CSV</span>
                            </label>
                            <label>
                                <input type="radio" name="download_format" value="xlsx">
                                <span>XLSX</span>
                            </label>
                        </div>
                    </div>

                    <!-- 3) Tableau des résultats -->
                    <div class="carte">
                        <div class="carte-corps">
                            <div class="conteneur-defilement">
                                <table class="table-donnees">
                                    <thead>
                                        <tr id="tableau-en-tete"></tr>
                                    </thead>
                                    <tbody id="tableau-corps"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Pagination -->
                    <div class="pagination">
                        <button id="prev-page">←</button>
                        <span class="page-indicator" id="page-number">1 / N</span>
                        <button id="next-page">→</button>
                    </div>

                </main>

            </div>
            <script>
                // Variable global JS con la URL absoluta a data_ventes.json
                window.DATA_JSON_URL_VENTES = "{{ url_for('static', filename='data_ventes.json') }}";
                window.DATA_JSON_URL_ACHATS = "{{ url_for('static', filename='data_achats.json') }}";
            </script>
            <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
            <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/index.js"></script>
            <script src="{{ url_for('static', filename='js/main.js') }}"></script>


        </div>
    </div>

</body>

</html>